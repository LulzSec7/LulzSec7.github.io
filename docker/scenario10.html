<h1 id="scenario-10-persisting-data-using-volumes">Scenario-10: Persisting Data Using Volumes</h1>
<blockquote>
<p>In this scenario, you'll learn how to use Docker Volumes to persistent data within Containers. Docker Volumes allow directories to be shared between containers and container versions.</p>
</blockquote>
<h2 id="docker-volumes-allows-you-to-upgrade-containers-restart-machines-and-share-data-without-data-loss.-this-is-essential-when-updating-database-or-application-versions.">&gt;Docker Volumes allows you to upgrade containers, restart machines and share data without data loss. This is essential when updating database or application versions.</h2>
<h2 id="step-1---data-volumes">Step 1 - Data Volumes</h2>
<blockquote>
<p>This example will use Redis as a way to persist data. Start a Redis container below, and create a data volume using the -v parameter. This specifies that any data saved inside the container to the /data directory should be persisted on the host in the directory /docker/redis-data.</p>
</blockquote>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">docker</span> run  -v /docker/redis-data:/data --name r1 -d redis  redis-server --appendonly yes</code></pre>
<blockquote>
<p>We can pipe data into the Redis instance using the following command.</p>
</blockquote>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">cat</span> data <span class="kw">|</span> <span class="kw">docker</span> exec -i r1 redis-cli --pipe</code></pre>
<blockquote>
<p>Redis will save this data to disk. On the host we can investigate the mapped direct which should contain the Redis data file.</p>
</blockquote>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">ls</span> /docker/redis-data</code></pre>
<blockquote>
<p>This same directory can be mounted to a second container. One usage is to have a Docker Container performing backup operations on your data.</p>
</blockquote>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">docker</span> run  -v /docker/redis-data:/backup ubuntu ls /backup</code></pre>
<h2 id="step-3---read-only-volumes">Step 3 - Read-only Volumes</h2>
<blockquote>
<p>Mounting Volumes gives the container full read and write access to the directory. You can specify read-only permissions on the directory by adding the permissions :ro to the mount.</p>
</blockquote>
<blockquote>
<p>If the container attempts to modify data within the directory it will error.</p>
</blockquote>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">docker</span> run -v /docker/redis-data:/data:ro -it ubuntu rm -rf /data</code></pre>
